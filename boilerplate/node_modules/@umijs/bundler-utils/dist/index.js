"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __exportStar = (this && this.__exportStar) || function(m, exports) {
    for (var p in m) if (p !== "default" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.isDepPath = exports.parseModuleSync = exports.parseModule = void 0;
const es_module_lexer_1 = require("@umijs/bundler-utils/compiled/es-module-lexer");
const esbuild_1 = require("@umijs/bundler-utils/compiled/esbuild");
const utils_1 = require("@umijs/utils");
const path_1 = require("path");
async function parseModule(opts) {
    await es_module_lexer_1.init;
    return parseModuleSync(opts);
}
exports.parseModule = parseModule;
function parseModuleSync(opts) {
    let content = opts.content;
    if (opts.path.endsWith('.tsx') || opts.path.endsWith('.jsx')) {
        content = (0, esbuild_1.transformSync)(content, {
            loader: (0, path_1.extname)(opts.path).slice(1),
            format: 'esm',
        }).code;
    }
    return (0, es_module_lexer_1.parse)(content);
}
exports.parseModuleSync = parseModuleSync;
function isDepPath(path) {
    const umiMonorepoPaths = ['umi/packages/', 'umi-next/packages/'];
    return (path.includes('node_modules') ||
        umiMonorepoPaths.some((p) => (0, utils_1.winPath)(path).includes(p)));
}
exports.isDepPath = isDepPath;
__exportStar(require("./https"), exports);
__exportStar(require("./types"), exports);
